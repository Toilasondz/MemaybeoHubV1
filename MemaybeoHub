-- Roblox Fix Lag Script with GUI
-- Features:
-- 1. Toggle button GUI
-- 2. Ultra Low Graphics mode
-- 3. Color-preserved Low Effects mode
-- 4. Auto Quality adjust by FPS

-- NOTE: Paste this into a LocalScript in StarterPlayerScripts

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- Create ScreenGui
local gui = Instance.new("ScreenGui")
gui.Parent = player:WaitForChild("PlayerGui")
gui.ResetOnSpawn = false

-- Create Toggle Button
local button = Instance.new("TextButton")
button.Size = UDim2.new(0,140,0,50)
button.Position = UDim2.new(0.05,0,0.35,0)
button.Text = "Fix Lag: OFF"
button.BackgroundColor3 = Color3.fromRGB(30,30,30)
button.TextColor3 = Color3.fromRGB(255,255,255)
button.Parent = gui
button.Active = true

local mode = 0 -- 0 = off, 1 = ultra, 2 = color-lowFX
local autoAdjust = true

-- Functions
local function ultraLow()
    local s = settings().Rendering
    s.QualityLevel = Enum.QualityLevel.Level01
    Lighting.GlobalShadows = false
    Lighting.FogEnd = 50
    for _,v in pairs(workspace:GetDescendants()) do
        if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") or v:IsA("Fire") then
            v.Enabled = false
        end
    end
end

local function colorLowFX()
    local s = settings().Rendering
    s.QualityLevel = Enum.QualityLevel.Level02
    Lighting.GlobalShadows = false
    for _,v in pairs(workspace:GetDescendants()) do
        if v:IsA("ParticleEmitter") then v.Rate = v.Rate * 0.3 end
    end
end

local function restore()
    settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
    Lighting.GlobalShadows = true
end

-- Auto FPS Adjust
local fps = 60
RunService.RenderStepped:Connect(function(dt)
    fps = 1/dt
    if autoAdjust then
        if fps < 35 then
            settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
        elseif fps > 55 then
            settings().Rendering.QualityLevel = Enum.QualityLevel.Level05
        end
    end
end)

-- Button Click
button.MouseButton1Click:Connect(function()
    mode = mode + 1
    if mode > 2 then
        mode = 0
        restore()
        button.Text = "Fix Lag: OFF"
        button.BackgroundColor3 = Color3.fromRGB(30,30,30)
    elseif mode == 1 then
        ultraLow()
        button.Text = "Ultra Low"
        button.BackgroundColor3 = Color3.fromRGB(120,40,40)
    elseif mode == 2 then
        colorLowFX()
        button.Text = "LowFX Colors"
        button.BackgroundColor3 = Color3.fromRGB(40,120,40)
    end
end)

print("Fix Lag Script Loaded!")

-- ICON BUTTON
local icon = Instance.new("ImageLabel", toggleButton)
icon.Size = UDim2.new(0, 20, 0, 20)
icon.Position = UDim2.new(0, 5, 0.5, -10)
icon.BackgroundTransparency = 1
icon.Image = "rbxassetid://102408429268015"

--===[ TÁC GIẢ / AUTHOR ]===--
local authorLabel = Instance.new("TextLabel", mainFrame)
authorLabel.Size = UDim2.new(1, -20, 0, 20)
authorLabel.Position = UDim2.new(0, 10, 1, -25)
authorLabel.BackgroundTransparency = 1
authorLabel.Text = "@hoangvanson_9k"
authorLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
authorLabel.Font = Enum.Font.GothamSemibold
authorLabel.TextSize = 14
authorLabel.TextXAlignment = Enum.TextXAlignment.Center

