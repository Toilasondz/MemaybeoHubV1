--== KAVO UI KẾT HỢP VỚI NÚT MỞ/ĐÓNG RIÊNG ==--

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Load the Kavo UI library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("ClickGUI Target", "Ocean") 

-- Lấy Frame chính của Kavo để điều khiển ẩn/hiện
local KavoMainFrame = nil
-- Cố gắng tìm frame của Kavo (Kavo thường đặt trong CoreGui hoặc PlayerGui)
for _, gui in pairs(PlayerGui:GetChildren()) do
    if string.find(gui.Name, "Kavo_") then
        KavoMainFrame = gui:FindFirstChildOfClass("Frame")
        break
    end
end
-- Nếu không tìm thấy trong PlayerGui, thử tìm trong CoreGui (cần Executor hỗ trợ)
if not KavoMainFrame then
    local CoreGui = game:GetService("CoreGui")
    for _, gui in pairs(CoreGui:GetChildren()) do
        if string.find(gui.Name, "Kavo_") then
            KavoMainFrame = gui:FindFirstChildOfClass("Frame")
            break
        end
    end
end

-- ----------------------------------------------------
-- A. THIẾT KẾ NÚT MỞ/ĐÓNG (CLICKGUI BUTTON)
-- ----------------------------------------------------

local ToggleButton = Instance.new("ScreenGui")
ToggleButton.Name = "CustomToggleButton"
ToggleButton.Parent = PlayerGui
ToggleButton.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local ButtonFrame = Instance.new("Frame")
ButtonFrame.Name = "ToggleFrame"
ButtonFrame.Parent = ToggleButton
ButtonFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45) -- Màu tối
ButtonFrame.BorderColor3 = Color3.fromRGB(0, 0, 0)
ButtonFrame.BorderSizePixel = 0
ButtonFrame.Size = UDim2.new(0, 50, 0, 50) -- Hình vuông 50x50
ButtonFrame.Position = UDim2.new(0.01, 0, 0.3, 0) -- Vị trí ban đầu
ButtonFrame.Active = true -- Cho phép kéo
ButtonFrame.Selectable = true

-- Bo tròn góc (sử dụng UICorner)
local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 6) -- Bán kính 6 pixel
Corner.Parent = ButtonFrame

-- Text/Icon
local ButtonLabel = Instance.new("TextLabel")
ButtonLabel.Name = "IconLabel"
ButtonLabel.Parent = ButtonFrame
ButtonLabel.BackgroundTransparency = 1
ButtonLabel.Size = UDim2.new(1, 0, 1, 0)
ButtonLabel.Text = "UI" -- Có thể thay bằng một icon
ButtonLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
ButtonLabel.Font = Enum.Font.Code
ButtonLabel.TextSize = 18

-- Logic Kéo/Di chuyển Nút
local dragging = false
local dragInput, dragStart, startPos
local function startDrag(input)
    dragging = true
    dragStart = input.Position
    startPos = ButtonFrame.Position
    input.Delta = Vector2.new(0, 0)
end
local function doDrag(input)
    if dragging then
        local delta = input.Position - dragStart
        ButtonFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end
local function stopDrag()
    dragging = false
end
ButtonFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        startDrag(input)
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        doDrag(input)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        stopDrag()
    end
end)

-- Logic Click Nút để Mở/Đóng Kavo UI
ButtonFrame.MouseButton1Click:Connect(function()
    if KavoMainFrame then
        KavoMainFrame.Visible = not KavoMainFrame.Visible
        ButtonLabel.TextColor3 = KavoMainFrame.Visible and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 255, 255)
    else
        game.StarterGui:SetCore("SendNotification", { Title = "Lỗi UI"; Text = "Không tìm thấy Frame chính của Kavo."; Duration = 3; })
    end
end)

-- ----------------------------------------------------
-- B. GIAO DIỆN KAVO TỐI GIẢN (Chỉ có sườn)
-- ----------------------------------------------------

local MainTab = Window:NewTab("Main")
local MainSection = MainTab:NewSection("Minimalist")

MainSection:NewLabel("Giao diện UI đã khởi tạo.")
MainSection:NewLabel("---")
MainSection:NewLabel("Không có chức năng nào được thêm vào.")
MainSection:NewLabel("Sử dụng nút 'UI' trên màn hình để ẩn/hiện.")

-- Thiết lập ban đầu: Ẩn Kavo UI và chỉ hiện nút Toggle
if KavoMainFrame then
    KavoMainFrame.Visible = false
end
